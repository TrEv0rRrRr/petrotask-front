<div class="task-create-dialog">
  <h2 mat-dialog-title>Crear Nueva Tarea</h2>

  <mat-dialog-content>
    <form [formGroup]="taskForm" class="task-form">
      <!-- Título de la tarea -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Título de la tarea</mat-label>
        <input
          matInput
          formControlName="title"
          placeholder="Ej: Inspección de válvulas de seguridad"
          maxlength="255"
        />
        <mat-error *ngIf="getFieldError('title')">
          {{ getFieldError("title") }}
        </mat-error>
      </mat-form-field>

      <!-- Descripción -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Descripción</mat-label>
        <textarea
          matInput
          formControlName="description"
          placeholder="Describe las actividades a realizar..."
          rows="3"
          maxlength="255"
        ></textarea>
        <mat-error *ngIf="getFieldError('description')">
          {{ getFieldError("description") }}
        </mat-error>
      </mat-form-field>

      <!-- Actividad asociada (REQUERIDO) -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Actividad asociada *</mat-label>
        <mat-select formControlName="activityId">
          <mat-option *ngFor="let activity of activities" [value]="activity.id">
            {{ activity.activityCode }} - {{ activity.description }}
          </mat-option>
        </mat-select>
        <mat-hint>La actividad es obligatoria para crear una tarea</mat-hint>
        <mat-error *ngIf="getFieldError('activityId')">
          {{ getFieldError("activityId") }}
        </mat-error>
      </mat-form-field>

      <!-- Employee ID -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>ID del Empleado</mat-label>
        <input
          matInput
          type="number"
          formControlName="employeeId"
          placeholder="0 para sin asignar"
          min="0"
        />
        <mat-hint>Deja en 0 para crear sin asignar</mat-hint>
        <mat-error *ngIf="getFieldError('employeeId')">
          {{ getFieldError("employeeId") }}
        </mat-error>
      </mat-form-field>

      <!-- Estado -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Estado inicial</mat-label>
        <mat-select formControlName="status">
          <mat-option
            *ngFor="let option of statusOptions"
            [value]="option.value"
          >
            {{ option.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()">Cancelar</button>
    <button
      mat-raised-button
      color="primary"
      (click)="onSubmit()"
      [disabled]="!taskForm.valid"
    >
      Crear Tarea
    </button>
  </mat-dialog-actions>
</div>
